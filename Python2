# ...................................
# Leistungsnachweis – Analyse Todesursachen
# Länder: Venezuela, Indien, Deutschland
# Datensatz: share-of-deaths-from-major-causes.csv
# ...................................

import pandas as pd
from matplotlib import pyplot as plt

# ...................................
# 1. FRAGESTELLUNG UND DATENBESCHAFFUNG (Text nur als Kommentar)
# ...................................

"""
### 1.1 Titel

Vergleich der Entwicklung wichtiger Todesursachen in Venezuela, Indien und Deutschland (1990–2016)

### 1.2 Fragestellung

Hauptfragestellung:
- Wie haben sich die Anteile der Todesfälle durch ausgewählte Krankheitsgruppen in Venezuela, Indien und Deutschland im Zeitraum 1990–2016 entwickelt?

Unterfragestellungen:
- Gibt es Unterschiede im Anteil der Todesfälle durch Infektions- und Parasitenkrankheiten zwischen Venezuela, Indien und Deutschland?
- Wie unterscheiden sich die Anteile nichtübertragbarer Krankheiten (z.B. Verdauungs- und Atemwegserkrankungen) zwischen diesen drei Ländern?
- Lassen sich typische Muster eines „epidemiologischen Übergangs“ erkennen (Weg von Infektionskrankheiten hin zu chronischen Erkrankungen)?

### 1.3 Datenquelle

Die Daten stammen aus dem Datensatz
„Share of deaths from major causes“ von Our World in Data,
basierend auf Mortalitätsstatistiken der WHO.

Es handelt sich um Sekundärdaten auf Länderebene.
Für jedes Land und Jahr werden prozentuale Anteile der Todesfälle
für verschiedene Ursachen angegeben.
"""

# ...................................
# 2. DATEN LADEN UND STRUKTUR VERSTEHEN
# ...................................

# CSV einlesen (Datei muss im gleichen Ordner liegen)
df = pd.read_csv("share-of-deaths-from-major-causes.csv")

print("Erste Zeilen des Datensatzes:")
print(df.head())
print("\nForm des Datensatzes (Zeilen, Spalten):", df.shape)
print("\nDatentypen:")
print(df.dtypes)

print("\nAnzahl fehlender Werte pro Spalte:")
print(df.isna().sum())

# Kurzer Hinweis zu den Variablentypen (als Kommentar):
"""
- Entity: kategorial (Ländername)
- Code: kategorial (Ländercode, z.B. DEU, IND, VEN)
- Year: diskrete numerische Variable (Jahr)
- Alle „Share of total deaths...“-Spalten: kontinuierliche numerische Variablen (Anteile in Prozent)
"""

# ...................................
# 2.1 Wichtige Spalten (Ursachen) automatisch finden und umbenennen
#     --> damit wir später einfache Namen wie "digestive", "infectious" usw. nutzen können
# ...................................

cols = df.columns.tolist()
print("\nSpaltennamen (zur Kontrolle):")
for c in cols:
    print(c)

# Wir suchen die Spalten mit bestimmten Teil-Strings im Namen.
# So sind wir robust, auch wenn die Spaltennamen sehr lang sind.

digestive_col = [c for c in cols if "digestive diseases" in c][0]
infectious_col = [c for c in cols if "infectious and parasitic diseases" in c][0]
respiratory_col = [c for c in cols if "respiratory diseases" in c and "infections" not in c][0]

print("\nAutomatisch gefundene Spaltennamen für unsere Analyse:")
print("Digestive:", digestive_col)
print("Infectious:", infectious_col)
print("Respiratory:", respiratory_col)

# Jetzt benennen wir diese Spalten in kurze, gut lesbare Namen um
rename_dict = {
    digestive_col: "digestive",
    infectious_col: "infectious",
    respiratory_col: "respiratory"
}

df = df.rename(columns=rename_dict)

print("\nKontrolle nach dem Umbenennen (Auszug):")
print(df[["Entity", "Code", "Year", "digestive", "infectious", "respiratory"]].head())

# ...................................
# 2.2 Zeitraum und Länder wählen
# ...................................

# Wir beschränken uns auf die Jahre ab 1990
df = df[df["Year"] >= 1990]

# Länder für Vergleich: Venezuela, Indien, Deutschland
countries_of_interest = ["Venezuela", "India", "Germany"]

df_sub = df[df["Entity"].isin(countries_of_interest)].copy()

print("\nGefilterter Datensatz (nur Venezuela, Indien, Deutschland ab 1990):")
print(df_sub.head())
print("\nForm des gefilterten Datensatzes:", df_sub.shape)
print("\nAnzahl Beobachtungen pro Land:")
print(df_sub["Entity"].value_counts())

"""

"""

# ...................................
# 2.3 Long-Format erstellen (für flexible Plots)
# ...................................

# Wir konzentrieren uns auf drei Ursachen:
cause_cols = ["digestive", "infectious", "respiratory"]

# melt -> von wide nach long
df_long = df_sub.melt(
    id_vars=["Entity", "Code", "Year"],
    value_vars=cause_cols,
    var_name="cause",
    value_name="share"
)

print("\nLong-Format (df_long) – erste Zeilen:")
print(df_long.head())
print("\nForm von df_long:", df_long.shape)

"""
Erklärung:
- Im Wide-Format haben wir eine Spalte pro Todesursache.
- Im Long-Format haben wir eine Spalte 'cause' (Name der Ursache)
  und eine Spalte 'share' (Anteil der Todesfälle).
- Das Long-Format ist oft einfacher für Plots und Gruppierungen.
"""

# ...................................
# 3. STATISTIK DER ROHDATEN
# ...................................

# 3.1 Anzahl unterschiedlicher Jahre und Länder
print("\nUnterschiedliche Jahre im Datensatz:", sorted(df_sub["Year"].unique()))
print("Anzahl Jahre pro Land:")
print(df_sub.groupby("Entity")["Year"].nunique())

# 3.2 Fehlende Werte nur für die relevanten Ursachen
print("\nFehlende Werte in den betrachteten Ursachen-Spalten:")
print(df_sub[cause_cols].isna().sum())

# 3.3 Deskriptive Statistik für die ausgewählten Ursachen
print("\nDeskriptive Statistik für die Ursachen (digestive, infectious, respiratory):")
print(df_sub[cause_cols].describe())

"""
Kommentar für den Bericht:
- Entity und Code sind kategorial.
- Year ist diskret (z.B. 1990, 1991, ...).
- 'digestive', 'infectious' und 'respiratory' sind kontinuierliche Variablen
  (Anteile in Prozent, nicht nur ganze Zahlen).
- Die deskriptive Statistik (min, max, Mittelwert, Quartile) zeigt, in welchem
  Bereich sich diese Anteile bewegen.
"""

# ...................................
# 3.4 Grafische Auswertung: Histogramme & Boxplot
# ...................................

# Histogramm für jede Ursache
for cause in cause_cols:
    plt.figure()
    df_sub[cause].hist(bins=20)
    plt.title(f"Verteilung des Anteils der Todesfälle durch {cause}-Erkrankungen")
    plt.xlabel("Anteil der Todesfälle (%)")
    plt.ylabel("Häufigkeit")
    plt.grid(True)
    plt.tight_layout()
    plt.show()

# Boxplot der drei Ursachen nebeneinander
plt.figure()
df_sub[cause_cols].boxplot()
plt.title("Boxplot der Anteile ausgewählter Todesursachen")
plt.ylabel("Anteil der Todesfälle (%)")
plt.tight_layout()
plt.show()

"""
"""

# ...................................
# 3.5 Zusammenhänge zwischen Variablen (Streudiagramm & Korrelation)
# ...................................

# Beispiel: Zusammenhang zwischen Infektions- und Atemwegserkrankungen
plt.figure()
plt.scatter(df_sub["infectious"], df_sub["respiratory"])
plt.title("Zusammenhang: Infektionskrankheiten vs. Atemwegserkrankungen")
plt.xlabel("Anteil Todesfälle durch Infektionskrankheiten (%)")
plt.ylabel("Anteil Todesfälle durch Atemwegserkrankungen (%)")
plt.grid(True)
plt.tight_layout()
plt.show()

# Korrelationsmatrix für die drei Ursachen
corr_matrix = df_sub[cause_cols].corr()
print("\nKorrelationsmatrix (digestive, infectious, respiratory):")
print(corr_matrix)

"""
"""

# ...................................
# 4. ANALYSE: ZEITVERLAUF JE LAND (LINIENDIAGRAMME)
# ...................................

# 4.1 Zeitverlauf der Infektionskrankheiten (infectious) pro Land
plt.figure()
for country in countries_of_interest:
    subset = df_sub[df_sub["Entity"] == country].sort_values("Year")
    plt.plot(subset["Year"], subset["infectious"], marker="o", label=country)

plt.title("Anteil der Todesfälle durch Infektionskrankheiten (1990–2016)")
plt.xlabel("Jahr")
plt.ylabel("Anteil der Todesfälle (%)")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()

# 4.2 Zeitverlauf der Verdauungserkrankungen (digestive)
plt.figure()
for country in countries_of_interest:
    subset = df_sub[df_sub["Entity"] == country].sort_values("Year")
    plt.plot(subset["Year"], subset["digestive"], marker="o", label=country)

plt.title("Anteil der Todesfälle durch Verdauungserkrankungen (1990–2016)")
plt.xlabel("Jahr")
plt.ylabel("Anteil der Todesfälle (%)")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()

# 4.3 Zeitverlauf der Atemwegserkrankungen (respiratory)
plt.figure()
for country in countries_of_interest:
    subset = df_sub[df_sub["Entity"] == country].sort_values("Year")
    plt.plot(subset["Year"], subset["respiratory"], marker="o", label=country)

plt.title("Anteil der Todesfälle durch Atemwegserkrankungen (1990–2016)")
plt.xlabel("Jahr")
plt.ylabel("Anteil der Todesfälle (%)")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()

"""
Beobachtungen 

- Deutschland:
  Der Anteil der Todesfälle durch Infektions- und Parasitenkrankheiten ist
  im gesamten Zeitraum relativ niedrig und meist stabil. Deutschland zeigt
  das typische Muster eines hochentwickelten Landes: Infektionskrankheiten
  spielen als Todesursache eine untergeordnete Rolle; wichtiger sind
  nichtübertragbare Krankheiten.

- Indien:
  In Indien ist der Anteil der Todesfälle durch Infektionskrankheiten im
  Vergleich höher, vor allem zu Beginn des Beobachtungszeitraums. Mit der
  Zeit sinkt dieser Anteil jedoch, was auf einen Ausbau des Gesundheitssystems,
  bessere Impfprogramme und allgemein bessere Lebensbedingungen hindeutet.
  Gleichzeitig gewinnen chronische Krankheiten an Bedeutung.

- Venezuela:
  Venezuela weist im Vergleich zu Deutschland höhere Anteile von Todesfällen
  durch Infektionskrankheiten auf. Politische und wirtschaftliche Instabilität
  kann dazu führen, dass Infektionskrankheiten relativ wichtig bleiben und
  die Versorgung nicht so stabil ist wie in hochentwickelten Ländern.

Interpretation:

- Die Unterschiede zwischen Deutschland, Indien und Venezuela lassen sich gut
  mit dem Konzept des epidemiologischen Übergangs erklären. Mit zunehmender
  wirtschaftlicher Entwicklung und besserem Zugang zu medizinischer Versorgung
  gehen Infektionskrankheiten zurück, und nichtübertragbare Krankheiten
  (z.B. Herz-Kreislauf, Krebs, chronische Atemwegs- oder Verdauungserkrankungen)
  werden zur wichtigsten Todesursache.

- Deutschland befindet sich klar in einem fortgeschrittenen Stadium dieses
  Übergangs, Indien ist in einem starken Wandel, und Venezuela zeigt ein
  Mischbild, das auch durch politische und ökonomische Faktoren beeinflusst wird.

Fazit

- Die Analyse der Todesursachen bestätigt die ursprüngliche Fragestellung:
  Es bestehen deutliche Unterschiede zwischen Venezuela, Indien und Deutschland.
  Deutschland hat ein Profil mit dominierenden nichtübertragbaren Erkrankungen
  und sehr niedrigen Anteilen von Infektionskrankheiten.
  Indien und Venezuela weisen höhere Anteile von Infektionskrankheiten auf,
  wobei Indien über die Zeit einen klaren Rückgang zeigt.

- Insgesamt zeigen die drei Länder verschiedene Stadien des epidemiologischen
  Übergangs. Damit lässt sich die Entwicklung der Todesursachen gut in einen
  grösseren gesundheitspolitischen und sozioökonomischen Kontext einordnen.
"""
